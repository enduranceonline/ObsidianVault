#apuntes #certificacion #eJPT
# ğŸ“Œ Searchsploit & Exploit-DB

## ğŸ„ Exploit-DB

- **Exploit Database (Exploit-DB)** es un repositorio pÃºblico mantenido por Offensive Security.  
- Contiene exploits, pruebas de concepto (PoCs) y referencias de vulnerabilidades.  
- EstÃ¡ orientado a pentesters y profesionales de seguridad para investigar fallos conocidos.  
- Se puede consultar desde la web:  
  ğŸ‘‰ [https://www.exploit-db.com](https://www.exploit-db.com)  

	**CategorÃ­as de exploits en Exploit-DB:**

- Local â†’ para escalar privilegios en una mÃ¡quina donde ya tenemos acceso.  
- Remote â†’ vulnerabilidades explotables de forma remota.  
- WebApps â†’ aplicaciones web vulnerables.  
- DoS â†’ denegaciÃ³n de servicio.  
- Shellcode â†’ cÃ³digo de payloads listos para inyectar.  

---

## ğŸ„ Searchsploit
- Herramienta incluida en Kali Linux que permite buscar en **Exploit-DB** desde la terminal.  
- Muy Ãºtil para pruebas en entornos sin conexiÃ³n a internet.  
- EstÃ¡ sincronizada con una copia local de la base de datos de Exploit-DB.  

### ğŸ‘‰ Uso bÃ¡sico
```bash
searchsploit <nombre_servicio> <versiÃ³n>
````

Ejemplo:

```bash
searchsploit proftpd 1.3
```

(Muestra exploits relacionados con esa versiÃ³n de ProFTPD)

---

### ğŸ‘‰ Opciones Ãºtiles

- `-c` â†’ bÃºsqueda **case sensitive** (distingue mayÃºsculas/minÃºsculas).
- `-e` â†’ buscar coincidencia **exacta** de tÃ©rminos.
- `-s` â†’ buscar por versiÃ³n exacta.
- `-t` â†’ excluir la ruta de archivos del resultado.
- `-m` â†’ copiar el exploit al directorio actual.
- `-x` â†’ mostrar el contenido completo del exploit.

---

### ğŸ‘‰ Ejemplo prÃ¡ctico

```bash
searchsploit ProFTPD 1.3
```

âœ” Devuelve resultados de exploits conocidos para la versiÃ³n 1.3.  
âŒ Para la versiÃ³n **1.3.1** puede no devolver nada (no siempre hay PoCs pÃºblicos).  
ğŸ‘‰ En estos casos, se recomienda probar con versiones cercanas o sin el Ãºltimo dÃ­gito de la versiÃ³n, ya que los exploits suelen afectar a **rangos de versiones**.

---
### ğŸ‘‰ Actualizar la base de datos

Para mantener **Searchsploit** sincronizado con Exploit-DB:

```bash
searchsploit -u
```

---

## ğŸ”¹ RelaciÃ³n con CVEs

- Muchos exploits de Exploit-DB estÃ¡n asociados a un **CVE** (Common Vulnerabilities and Exposures).

- El CVE permite correlacionar la vulnerabilidad con otras fuentes (NVD, Mitre, etc.).

Ejemplo de exploit en Searchsploit:

```
ProFTPD 1.3.x - 'mod_copy' Remote Command Execution (CVE-2015-3306)
```

---

## ğŸ”¹ Buenas prÃ¡cticas en el uso de Searchsploit

1. Siempre validar primero con `nmap -sV` la **versiÃ³n real** del servicio.
2. Buscar exploits con y sin el Ãºltimo dÃ­gito de la versiÃ³n (`1.3` vs `1.3.1`).
3. Usar el CVE como referencia para mayor precisiÃ³n.
4. Recordar que no todos los exploits pÃºblicos son fiables o funcionales al 100%.

---

# ğŸ” Fuerza Bruta (Brute Force)

La **fuerza bruta** es una tÃ©cnica utilizada para averiguar contraseÃ±as o claves probando sistemÃ¡ticamente mÃºltiples combinaciones hasta encontrar la correcta. Se usa en el contexto de **enumeraciÃ³n y explotaciÃ³n de servicios**, sobre todo cuando se identifican usuarios o posibles accesos en un sistema vÃ­ctima.

---

## âš¡ Tipos de Fuerza Bruta

### 1. **Fuerza Bruta Total**

- Consiste en **probar todas las combinaciones posibles** de caracteres.
    
- **No es habitual** en auditorÃ­as, ya que:
    
    - Consume **muchos recursos**.
        
    - Requiere una **mÃ¡quina muy potente**.
        
    - Puede tardar muchÃ­simo tiempo.
    
- **GarantÃ­a:** siempre se encontrarÃ¡ la contraseÃ±a, pero el coste es elevado.

---

### 2. **Fuerza Bruta con Diccionario**

- En lugar de probar todas las combinaciones, se utilizan **archivos predefinidos (diccionarios)** con contraseÃ±as comunes o filtradas.
    
- CaracterÃ­sticas:
    
    - Depende del diccionario que se use.
        
    - Solo se encontrarÃ¡ la contraseÃ±a si estÃ¡ en el diccionario.
        
    - Es **mÃ¡s rÃ¡pida y eficiente** que la total.
        
    - **Menos efectiva** si la contraseÃ±a es muy compleja o no estÃ¡ en el diccionario.

---

## ğŸ“š Diccionarios

Un **diccionario** es un archivo que contiene listas de contraseÃ±as (o usuarios) que se van a probar contra el objetivo.

- **Ejemplo clÃ¡sico en certificaciones y laboratorios:**
    
    - `rockyou.txt`
    
- Â¿MÃ¡s grande = mejor?
    
    - **Depende.**
    - Un diccionario muy grande aumenta la probabilidad de Ã©xito, pero tambiÃ©n incrementa el tiempo de ejecuciÃ³n.

---

### ğŸ“‚ Diccionarios comunes en Kali Linux

**ContraseÃ±as:**

- `/usr/share/wordlists/rockyou.txt`

- `/usr/share/wordlists/seclists/Passwords/2023-200_most_used_passwords.txt`

- `/usr/share/wordlists/wfuzz/others/common_pass.txt`

**Usuarios:**

- `/usr/share/wordlists/metasploit/unix_passwords.txt`
- `/usr/share/wordlists/metasploit/unix_users.txt`

---

## ğŸ”§ Herramientas para Fuerza Bruta de Servicios

- **Metasploit**  
    Incluye mÃ³dulos auxiliares para ataques de fuerza bruta contra servicios especÃ­ficos.

- **Hydra**  
    Una de las herramientas mÃ¡s utilizadas para ataques de fuerza bruta.  
    Permite especificar diccionarios de usuarios y contraseÃ±as, y soporta mÃºltiples protocolos (FTP, SSH, HTTP, SMB, etc.).

---

## ğŸ“ Ejemplo prÃ¡ctico: Hydra contra FTP

```bash
# Ataque de fuerza bruta contra un servicio FTP
hydra -l usuario -P /usr/share/wordlists/rockyou.txt ftp://192.168.1.100
```

- `-l usuario` â†’ Usuario objetivo (si lo conocemos).
    
- `-P` â†’ Diccionario de contraseÃ±as.
    
- `ftp://IP` â†’ Servicio e IP de la vÃ­ctima.
    

Si no conocemos el usuario podemos usar:

```bash
hydra -L /usr/share/wordlists/metasploit/unix_users.txt -P /usr/share/wordlists/rockyou.txt ftp://192.168.1.100
```

---

# ğŸ” Fuerza Bruta â€“ Herramientas

La fuerza bruta no se realiza manualmente: se **automatizan las peticiones** mediante herramientas que prueban mÃºltiples combinaciones de usuarios y contraseÃ±as contra un servicio determinado.

---

## âš™ï¸ Herramientas principales

### 1. **Burp Suite**

- Enfocado a **aplicaciones web**.
    
- Permite capturar peticiones HTTP/HTTPS y **automatizar ataques de fuerza bruta** en formularios de login.
    
- Se utiliza junto con diccionarios de usuarios/contraseÃ±as.
    

---

### 2. **Metasploit**

- Framework de explotaciÃ³n muy completo.
- Incluye **mÃ³dulos auxiliares** que permiten realizar ataques de fuerza bruta a distintos servicios.
- Ventajas:
    
    - AutomatizaciÃ³n sencilla.
        
    - Gran compatibilidad con distintos servicios (SMB, FTP, SSH, etc).
        
    - Se integra con diccionarios del propio framework o externos.

#### ğŸ“Œ MÃ³dulos Ãºtiles para fuerza bruta:

- **SMB**
    
    - `scanner/smb/smb_login` â†’ prueba combinaciones usuario/contraseÃ±a.
        
    - `scanner/smb/smb_enumusers` â†’ enumera usuarios de un dominio/host.

- **FTP**
    
    - `scanner/ftp/ftp_login`
        
- **SSH**
    
    - `scanner/ssh/ssh_enumusers`
        
    - `scanner/ssh/ssh_login`

#### ğŸ”‘ Flujo tÃ­pico en Metasploit:

1. **search** â†’ localizar mÃ³dulo (`search smb_login`).
2. **use mÃ³dulo** â†’ cargar el mÃ³dulo (`use scanner/smb/smb_login`).
3. **show options** â†’ ver parÃ¡metros requeridos.
4. **set RHOSTS / USER_FILE / PASS_FILE** â†’ configurar objetivos y diccionarios.
5. **run** â†’ ejecutar ataque.

---

### 3. âš”ï¸ Hydra

- **Open source**

- Permite hacer ataques de fuerza bruta sobre mÃºltiples protocolos:

> **SSH, FTP, HTTP, SMB, MySQL, RDP, Telnet, etc.**

- Ataca tanto **usuarios** como **contraseÃ±as**.
- Viene **instalado en Kali Linux** por defecto, si no:

```bash
  sudo apt-get install hydra
 ```

---
#### ParÃ¡metros principales

- `-h` â†’ Ayuda
- `-L` â†’ Diccionario de **usuarios**
- `-l` â†’ Usuario **concreto**
- `-P` â†’ Diccionario de **contraseÃ±as**
- `-p` â†’ ContraseÃ±a **concreta**
- `-t` â†’ NÃºmero de **hilos** (conexiones simultÃ¡neas, por defecto 16)

---
#### ğŸ“‚ Ejemplos de uso

##### 1ï¸âƒ£ SSH

```bash
hydra -L users.txt -P passwords.txt ssh://[IP]
hydra -l admin -P passwords.txt ssh://[IP]
hydra -L users.txt -p password123 ssh://[IP]
```

##### 2ï¸âƒ£ FTP

```bash
hydra -L users.txt -P passwords.txt ftp://[IP]
hydra -l admin -p qwerty ftp://[IP]
```

##### 3ï¸âƒ£ HTTP (formularios web)

```bash
# Un usuario y diccionario de contraseÃ±as
sudo hydra -l admin -P /usr/share/wordlists/rockyou.txt [IP] http-post-form \
"/login.php:username=^USER^&password=^PASS^:Login failed"

# Diccionario de usuarios y contraseÃ±as
sudo hydra -L users.txt -P passwords.txt [IP] http-post-form \
"/login.php:username=^USER^&password=^PASS^:mensaje de error"
```

> En el **post-form**, se debe identificar el campo de usuario (`username`), contraseÃ±a (`password`) y el mensaje de error que devuelve la aplicaciÃ³n al fallar (ej: _Login failed_).

##### 4ï¸âƒ£ SMB

```bash
hydra -L users.txt -P passwords.txt smb://[IP]
hydra -l tom -P passwords.txt smb://[IP]
hydra -L users.txt -p qwerty smb://[IP]
```

---
#### ğŸ“– Notas importantes

- La **efectividad depende del diccionario** usado (ej: `rockyou.txt`).
- Se recomienda ajustar los **hilos** con `-t` para no sobrecargar el servicio.
- Hydra **no filtra falsos positivos**, por lo que hay que revisar los resultados.
- En entornos reales, es comÃºn usar **Burp Suite** antes para capturar la peticiÃ³n exacta y despuÃ©s adaptarla a Hydra.
- Herramienta especializada en fuerza bruta.
- Muy rÃ¡pida y flexible.
- Compatible con una gran variedad de servicios:
    - **SSH, FTP, HTTP, SMB, RDP, Telnet**, etc.
- Sintaxis bÃ¡sica:

```bash
hydra -L usuarios.txt -P contraseÃ±as.txt ssh://10.0.0.5
```

- Permite especificar **listas de usuarios** (-L) y **diccionarios de contraseÃ±as** (-P).

---

### 4. **Medusa**

- Similar a Hydra, menos popular.
- Soporta ataques rÃ¡pidos y paralelos.
- Menor uso en entornos de certificaciones como el eJPT.

---

## ğŸ“˜ Nota para el eJPT

- Con **Metasploit** y **Hydra** es suficiente para cubrir la mayorÃ­a de escenarios.
- Ambos permiten atacar cualquier servicio enumerado previamente, usando diccionarios como `rockyou.txt`.

---

## ğŸ§ª Ejercicio PrÃ¡ctico

1. **Enumerar servicios con Nmap**:

 ```bash
  nmap -sV 10.0.3.9
 ```

ğŸ‘‰ Detectar quÃ© servicios soportan login (FTP, SSH, SMB, etc).

2. **Probar con Hydra** contra SSH:

```bash
hydra -L /usr/share/wordlists/metasploit/unix_users.txt \
-P /usr/share/wordlists/metasploit/unix_passwords.txt \
ssh://10.0.3.9
 ```

3. **Probar con Metasploit** contra SMB:

```bash
msfconsole
search smb_login
use auxiliary/scanner/smb/smb_login
set RHOSTS 10.0.3.9
set USER_FILE /usr/share/wordlists/metasploit/unix_users.txt
set PASS_FILE /usr/share/wordlists/metasploit/unix_passwords.txt
run
 ```

4. **Analizar resultados** â†’ comprobar si se obtiene acceso vÃ¡lido.

---
   